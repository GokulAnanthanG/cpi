<!-- SSB Course Plan And Implementation -->
<!--
    ****************
    G.GOKUL ANANTHAN
    ****************
UNDER THE GUIDANCE OF
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    MR.Ashok Lingam Sir  
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
-->
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SSB course plan and implementation</title>
    <link rel="stylesheet" href="assets/css/viewCpi.css">
    <link rel="shortcut icon" href="assets/img/favicon.ico" type="image/x-icon">
    <!-- CSS only -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">
    <link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"
        integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
</head>

<body>
    <header>
        <nav>
            <div class="box">
                <div class="box1"><img src="assets/img/logo2.png" class="img-fluid" alt=""></div>
                <div class="box2"><a href="index.html"><button title="home" class="btn"><i
                                class="fa fa-home"></i></button></a>&nbsp; </div>
            </div>
        </nav>
    </header>
    <br>
    <main>
        <button class="rep btn btn-success" title="export as excel file" id="excel"><i
                class="fa fa-file-excel-o"></i></button>
        <button class="rep btn btn-danger" title="export as pdf file" id="pdf"><i class="fa fa-file-pdf-o"></i></button>
        <button class="rep btn btn-warning" title="delete" id="delete"><i class="fa fa-trash"></i></button>
        <div class="container card p-1">
            <center>
                <form id="frm">
                    <table id="report-table">
                        <thead>
                            <tr>
                                <td colspan="9"></td>
                            </tr>
                            <tr>
                                <td align="center" colspan="9">SRI SANKARA BHAGAVATHI ARTS AND SCIENCE COLLEGE,
                                    KOMMADIKOTTAI
                                </td>

                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td align="center" colspan="9">Course plan and Implementaion</td>

                            </tr>
                            <tr>
                                <th>Course:</th>
                                <td id="course"> </td>
                                <td></td>
                                <th>Programme:</th>
                                <td id="programme"></td>
                                <td colspan="4"></td>

                            </tr>
                            <tr>
                                <th>Code:</th>
                                <td id="code"> </td>
                                <td></td>
                                <th>Batch:</th>
                                <td id="batch"></td>
                                <td colspan="4"></td>

                            </tr>
                            <tr>
                                <th>Type:</th>
                                <td id="type"> </td>
                                <td></td>
                                <th>Hrs/Week:</th>
                                <td id="hrs_week"></td>
                                <td colspan="4"></td>

                            </tr>
                            <tr>
                                <th>Teacher:</th>
                                <td id="teacher"> </td>
                                <td></td>
                                <th>Credit:</th>
                                <td id="credit"></td>
                                <td colspan="4"></td>

                            </tr>
                            <tr>
                                <th>Sem:</th>
                                <td id="sem"> </td>
                                <td></td>
                                <th>No Of Students:</th>
                                <td id="noOfStudents"></td>
                                <td colspan="4"></td>

                            </tr>

                            <tr>
                                <td>COURSE OUTCOMES :</td>
                                <td colspan="8"></td>
                            </tr>
                        <tbody id="co"></tbody>
                        <tr>
                            <td colspan="3">Course Plan</td>

                            <td colspan="6">Course Implementation</td>
                        </tr>

                        <tr>
                            <td><b>S.NO</b></td>
                            <td><b>TOPIC</b></td>
                            <td><b>NO OF HRS</td>
                            <td><b>DATE</b></td>
                            <td><b>PERIOD</b></td>
                            <td><b>MEtdODOLOGY<br>AND<br>ACTIVITIES</b></td>
                            <td><b>ICT TOOLS USED</b></td>
                            <td><b>CONTINUOUS<br>ASSESSMENT<br>TYPE<br>USED</b></td>
                            <td><b>REMARK</b></td>
                        </tr>
                        <tbody id="cpi"></tbody>
                        <tr>
                        <tr>
                            <td></td>
                            <td>TOTAL HOURS ALLOTTED = </td>
                            <td id="THA"> </td>
                            <td colspan="7"></td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>TOTAL HOURS PLANNED = </td>
                            <td id="THP"> </td>
                            <td><b>Teacher Signature:</b></td>
                            <td colspan="6"> </td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>TOTAL HOURS TAKEN = </td>
                            <td id="THT"> </td>
                            <td><b>HOD Signature:</b></td>
                            <td colspan="6">
                            </td>

                        </tr>
                        </tr>
                        </tbody>
                    </table>
                </form>
            </center>
        </div>
    </main>
    <!-- #region -->

    <div class="toast-container position-fixed bottom-0 end-0 p-3">
        <div id="liveToast" class="toast" role="alert" aria-live="assertive" aria-atomic="true">
            <div class="toast-header">
                <img src="assets/img/favicon.ico" class="img-fluid rounded me-2" alt="...">
                <strong class="me-auto">SSB</strong>
                <small>info</small>
                <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
            </div>
            <div class="toast-body">
                Hello, world! This is a ssb message.
            </div>
        </div>
    </div>
    <!-- #endregion -->
    <br>
    <footer>
        <p align="center">Â© Sri Sankara Bhagavthi Arts & Science College. All Rights Reserved</p>
    </footer>
    <!-- JavaScript Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf"
        crossorigin="anonymous"></script>
    <!--jq-->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <!--tabletoexcel-->
    <script src="https://cdn.rawgit.com/rainabba/jquery-table2excel/1.1.0/dist/jquery.table2excel.min.js"></script>
    <!--tabletopdf-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"
        integrity="sha512-GsLlZN/3F2ErC5ifS5QtgpiJtWd43JWSuIgh7mbzZ8zBps+dvLusV+eNQATqgA/HdeKFVgA5v3S/cIrLF7QnIg=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script>
        document.getElementById("pdf").addEventListener("click", () => {
            var param = new window.URLSearchParams(window.location.search);
            var table = document.getElementById("report-table");
            html2pdf(table, { filename: `${param.get("batch")}-cod:${param.get("code")}CPI.pdf` });
        })
    </script>

    <script>
        $(document).ready(() => {
            $(".spinner").fadeOut();
            var param = new window.URLSearchParams(window.location.search);


            $.ajax({
                type: "post",
                url: "./php/getCpi.php",
                data: { code: param.get("code"), batch: param.get("batch") },
                success: (d) => {
                    if (Number(d) !== 0) {
                        let data = JSON.parse(d);
                        $("#course").html(data[0]);
                        $("#code").html(data[1]);
                        $("#type").html(data[2]);
                        $("#teacher").html(data[3]);
                        $("#sem").html(data[4]);
                        $("#programme").html(data[5]);
                        $("#batch").html(data[6]);
                        $("#hrs_week").html(data[7]);
                        $("#credit").html(data[8]);
                        $("#noOfStudents").html(data[9]);
                        $("#THA").html(data[data.length - 3]);
                        $("#THP").html(data[data.length - 2]);
                        $("#THT").html(data[data.length - 1]);
                        console.log(data);
                        data[17].forEach((co, i) => {
                            $("#co").append(`<tr><td>co${i + 1}</td><td colspan="7">${co}<td><tr>`);
                        });
                        data[10].forEach((e, i) => {
                            $("#cpi").append(`
                            <tr><td>${i + 1}</td><td>${e}</td><td>1</td><td> ${data[11][i] == "null" ? " " : data[11][i]}</td>
                            <td> ${data[12][i] == "null" ? " " : data[12][i]}</td>
                            <td>${data[13][i] == "null" ? " " : data[13][i]}</td>
                            <td>${data[14][i] == "null" ? " " : data[14][i]}</td>
                            <td>${data[15][i] == "null" ? " " : data[15][i]}</td>
                            <td> ${data[16][i] == "null" ? " " : data[16][i]} </td>
                                </tr>
                                
                            `)
                        })
                    }
                    else {
                        $(".toast-body").html("oops failed to get cpi :(");
                        $("#liveToast").toast("show");
                        setTimeout(() => { window.location.replace("index.html") }, 2000)
                    }
                },
                error: (err) => {
                    console.log(err); $(".toast-body").html("oops something went wrong :( try again later")
                    $("#liveToast").toast("show")
                }
            });

            $("#excel").click(() => {

                $("#report-table").table2excel({

                    filename: `${param.get("batch")}-cod:${param.get("code")}CPI.xls`
                });
            })
            $("#delete").click(() => {
                if (confirm("Are you sure ?")) {
                    $.ajax({
                        type: "post",
                        url: "./php/delete.php",
                        data: { code: param.get("code"), batch: param.get("batch") },
                        success: (d) => {
                            if (Number(d) == 1) {
                                $(".toast-body").html("deleted successfuly");
                                $("#liveToast").toast("show");
                                setTimeout(() => { window.location.replace("index.html") }, 2000)
                            }
                            else {
                                $(".toast-body").html("oops failed to  delete cpi :( try again later");
                                $("#liveToast").toast("show");
                            }
                        },
                        error: (err) => { console.log(err); }
                    })

                }
            })

        });
    </script>
</body>

</html>